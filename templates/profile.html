{% extends 'base.html' %}
{% block ul %}
<li><a href="/" class="btn btn-outline-dark">Home</a></li>
<li><a href="/courts" class="btn btn-outline-dark">Courts</a></li>
{% if session.get("token") %}
<li><a href="/booking" class="btn btn-outline-dark">Bookings</a></li>
<li><a href="/profile" class="btn btn-dark">Profile</a></li>
{% else %}
<li><a href="/login" class="btn btn-dark">Login</a></li>
{% endif %}
{% endblock ul %}
{% block sub %}
<a href="/" class="btn btn-outline-dark">Home</a>
<a href="/courts" class="btn btn-outline-dark">Courts</a>
<a href="/booking" class="btn btn-outline-dark">Bookings</a>
{% if session.get("token") %}
<a href="/profile" class="btn btn-dark">Profile</a>
{% else %}
<a href="/login" class="btn btn-dark">Login</a>
{% endif %}
{% endblock sub %}
{% block main %}
<div class="container-fluid">
    <h1>User Profile</h1>
    <div class="profile-details">
        <div id="view-mode">
            <!-- Profile info displayed when not in edit mode -->
            <br>
            <h3>Email: {{data["email"]}}</h3>
            <p>Name: {{data["data"]["name"]}}</p>
            <p>Age: {{age}}</p>
            <p>Interests: {{data["data"]["interest"]}}</p>
            <button id="edit-mode-btn" class="btn btn-primary">Edit</button>
            <a class="btn btn-danger" href="/logout">Logout</a>
        </div>
        <div id="edit-mode" style="display: none;">
            <!-- Form for editing profile info displayed when in edit mode -->
            <form id="edit-form" method="post" action="/profile">
                <div class="form-group">
                    <label for="name">Name:</label>
                    <input type="text" class="form-control" id="name" name="name" value='{{data["data"]["name"]}}'>
                </div>
                <div class="form-group">
                    <label for="born">Born Year:</label>
                    <input minlength="4" maxlength="4" type="number" class="form-control" id="born" name="born"
                        min="{{year-100}}" max="{{year}}" value='{{data["data"]["born"]}}'>
                </div>
                <div class="form-group">
                    <label for="interests">Interests:</label>
                    <select class="form-control" id="interest" name="interest">
                        <option value="badminton">Badminton</option>
                        <option value="basketball">Basketball</option>
                        <option value="futsal">Futsal</option>
                        <option value="tennis">Tennis</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Save Changes</button>
                <button type="button" id="cancel-edit-btn" class="btn btn-dark">Cancel</button>
            </form>
        </div>
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('edit-mode-btn').addEventListener('click', function () {
            document.getElementById('view-mode').style.display = 'none';
            document.getElementById('edit-mode').style.display = 'block';
        });

        document.getElementById('cancel-edit-btn').addEventListener('click', function () {
            document.getElementById('edit-mode').style.display = 'none';
            document.getElementById('view-mode').style.display = 'block';
        });
    });

    var interest = '{{data["data"]["interest"]}}';

    var selectElement = document.getElementById('interest');
    for (i = 0; i < selectElement.options.length; i++) {
        if (selectElement.options[i].value === interest) {
            selectElement.options[i].selected = true;
            break;
        }
    }
</script>
{% endblock main%}